#Include "rwmake.ch"        // incluido pelo assistente de conversao do AP5 IDE em 10/02/00
#INCLUDE "REAJTAR.CH"
#define D_CODIGO   1
#define D_DESCRI   2
#define D_ANTIGO   3
#define D_VERBA    4
#define D_PERC     5
#define D_REAJ     6
#define D_NOVO     7
#define D_ARRE     8

User Function reajtar()        // incluido pelo assistente de conversao do AP5 IDE em 10/02/00

Local cHelp	:= ""
Local aHelp	:= {}
Local aHelpI:= {}
Local aHelpE:= {}

//зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Declaracao de variaveis utilizadas no programa atraves da funcao    Ё
//Ё SetPrvt, que criara somente as variaveis definidas pelo usuario,    Ё
//Ё identificando as variaveis publicas do sistema utilizadas no codigo Ё
//Ё Incluido pelo assistente de conversao do AP5 IDE                    Ё
//юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды

SetPrvt("CDESC1,CDESC2,CDESC3,CSTRING,AORD,ARETURN")
SetPrvt("NOMEPROG,ALINHA,NLASTKEY,CPERG,NORDEM,NPOSANT")
SetPrvt("NPOSATU,NORMAL,DESCANSO,TITULO,AT_PRG,WCABEC0")
SetPrvt("WCABEC1,CONTFL,LI,NTAMANHO,NOPCX,AHEADER")
SetPrvt("AALTER,ATELA,AGETS,NUSADO,ACOLS")
SetPrvt("WNREL,CTARDE,CTARATE,NCRITERIO,NARREDONDA,NRELATU")
SetPrvt("NTARFUNAMB,CFILDE,CFILATE,CCCDE,CCCATE,CMATDE")
SetPrvt("CMATATE,CFUNDE,CFUNATE,CCATEGORIA,LREPARA,NUSAR")
SetPrvt("CDEONDE,CTIP,NSAVREC,ACOLSTAR,ATARREAJ,ARECTAR")
SetPrvt("ATOTTAR1,ATOTFUN1,ATOTCC1,ATOTFIL1,ATOTEMP1,ATOTALIZA")
SetPrvt("AINFO,APOSICAO1,CONTINUA,NELEM,NTIPATU,CARQDBF")
SetPrvt("CARQNTX,XTELA,BHOTAREA,CSAVSCRVT,CSAVSCRVP,CSAVSCRHT")
SetPrvt("CSAVSCRHP,CURLEN,NCOLANT,NLINGETD,CTITULO,AC")
SetPrvt("AR,ACGD,CLINHAOK,CTUDOOK,LRETMOD2,AFAIXAS")
SetPrvt("N,NREGISTROS,NCNT,NITENS,NREG,CFILIALANT")
SetPrvt("CCCANT,CFUANT,CMATANT,LNOVAMAT,LIMPCABE,LIMPFUNC")
SetPrvt("LMUDOUMAT,NRECNO,NTARNOVA,NTARANTI,NTARPERC,NVALARRED")
SetPrvt("K,NPOS,NRESTO,CCPORET,J,CCHAVERX_COD")
SetPrvt("NCOL,CCOD,CTXT,CALIAS,AARRAY1,X")
SetPrvt("CDET,AFIELDS,CINDCOND,CDESCFIL,")

// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #INCLUDE "REAJTAR.CH"

// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_CODIGO   1
// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_DESCRI   2
// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_ANTIGO   3
// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_VERBA    4
// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_PERC     5
// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_REAJ     6
// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_NOVO     7
// Movido para o inicio do arquivo pelo assistente de conversao do AP5 IDE em 10/02/00 ==> #define D_ARRE     8

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё REAJTAR  Ё Autor Ё Emerson Rosa de Souza   Ё Data Ё 17/12/99 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Aumento Para Tarefas                                         Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe   Ё REAJTAR(void)                                                Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁParametrosЁ                                                              Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso      Ё Generico                                                     Ё╠╠
╠╠цддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё         ATUALIZACOES SOFRIDAS DESDE A CONSTRU─AO INICIAL.               Ё╠╠
╠╠цддддддддддддбддддддддддбддддддбдддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁProgramador Ё Data     Ё BOPS Ё  Motivo da Alteracao                     Ё╠╠
╠╠цддддддддддддеддддддддддеддддддедддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁMarina      Ё 30/08/00 Ё------ЁValidacao Filial/Acesso.Retirada parte DOSЁ╠╠  
╠╠ЁPedro Eloy  Ё 26/02/04 ЁQNC811ЁAjuste nas definicoes das variaveis locaisЁ╠╠  
╠╠Ё            Ё          Ё00693 Ёe passado os parametros nas funcoes.      Ё╠╠  
╠╠Ё      	   Ё 14/10/05 Ё003252ЁAjuste na gravacao da data de reajuste    Ё╠╠
╠╠ЁEquipe RH   Ё 09/01/06 Ё091275ЁRetorno do programa antigo que nao faz a  Ё╠╠  
╠╠Ё            Ё          Ё      Ёgeracao de novas tarefas no SRO.          Ё╠╠  
╠╠ЁTania       Ё31/03/2006Ё096251ЁAcerto na sequencia dos parametros para a Ё╠╠  
╠╠Ё            Ё          Ё      Ёfuncao ValidPerg.                         Ё╠╠  
╠╠ЁNatie       Ё30/10/06  Ё104988ЁMelhoria no help da pergunta              Ё╠╠  
╠╠юддддддддддддаддддддддддаддддддадддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis Locais(Basicas)                             Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cDesc1  := STR0001		//"Aumento Para Tarefas."
cDesc2  := STR0002		//"O aumento ser═ aplicado sobre as tarefas definidas nos Parametros,"
cDesc3  := STR0003		//"reajustando automaticamente os lancamentos dos funcionarios."
cString := "SRA"	    // Alias do arquivo principal (Base)

aOrd := {STR0004,STR0005,STR0007}  //"Matricula"###"Centro de Custo"###"FunГЦo" 

/*
здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё Variaveis de Acesso do Usuario                               Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
cAcessaSRA	:= &( " { || " + ChkRH( "REAJTAR" , "SRA" , "2" ) + " } " )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis Private(Basicas)                            Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aReturn  := {STR0008, 1,STR0009, 2, 2, 1, "",1 }	//"Zebrado"###"Administra┤└o"
NomeProg := "REAJTAR"
aLinha   := {}
nLastKey := 0
cPerg    := "REAJTA"
nOrdem   := 0
n 		 := 1
aRegs	 :=	{}

aHelp := {	"Informe ou selecione a categorias dos ",;
			"funcionarios para filtro dos dados .",;
			"Esta informacao somente sera valida para ",;
			" impressao do relatorio." }
aHelpE:= {	"Informe o seleccione las categorias de ",;
             "los empleados en el filtro de los datos.",;
             "Esta informacion solo tendra validez ",;
             "para la impresion del informe. " } 

aHelpI:= {	"Indicate or select the employes ",;
            "categories to filter the data. ",; 
            "This information will only be ",;
            "valid for printing the report."}

PutSX1Help("P"+cHelp,aHelp,aHelpI,aHelpE)	 

/*
зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
Ё            Grupo   Ordem Pergunta Portugues Pergunta Espanhol  Pergunta Ingles    Variavel Tipo Tamanho Decimal Presel  GSC   Valid             Var01      Def01  DefSPA1  DefEng1  Cnt01  Var02 Def02 DefSpa2 DefEng2  Cnt02 Var03 Def03 DefSpa3 DefEng3 Cnt03 Var04  Def04  DefSpa4 DefEng4 Cnt04 Var05 Def05  DefSpa5 DefEng5 Cnt05  XF3 GrgSxg cPyme aHelpPor aHelpEng aHelpSpa cHelp    Ё
юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
Aadd(aRegs,{"REAJTA","15","Qual Categoria  ?","©Que Categoria  ?","Which Category  ?","mv_chf","C" ,1      ,0      ,0     ,"G"  ,"fCategoria(.T.)","mv_par15",""    ,""      ,""      ,"I"   ,""   ,""   ,""     ,""     ,""   ,""   ,""   ,""    ,""     ,""    ,""   ,""    ,""     ,""     ,""   ,""   ,""   ,""     ,""      ,""   ,""  ,""   ,"S"  ,aHelp  ,aHelpI  ,aHelpE  ,})
ValidPerg(aRegs,"REAJTA",.T.)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Define Variaveis Private(Programa)                           Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
nPosAnt  := nPosAtu  := 6
Normal   := Descanso := 0

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Variaveis Utilizadas na funcao IMPR                          Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Titulo   := ""
AT_PRG   := "REAJTAR"
wCabec0  := 1
wCabec1  := STR0010+Dtoc(dDataBase)	//"Data Base: "
CONTFL   := 1
LI       := 0
nTamanho := "M"

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Incluir na GetDados							                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
nOpcx := 3

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Obtem os Percentuais de Aumento                              Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aHeader := {}

Aadd(aHeader,{STR0016,"TAREFADE"  ,"@E 999,999,999,999.99", 15 , 2 , "positivo()" , "Ш" , "N" , "  "," " })	//"Faixa De"
Aadd(aHeader,{STR0017,"TAREFAATE" ,"@E 999,999,999,999.99", 15 , 2 , "positivo()" , "Ш" , "N" , "  "," " })	//"Faixa Ate"
Aadd(aHeader,{STR0018,"TAREFAPERC","@E 999.999999"        , 10 , 6 , "positivo()" , "Ш" , "N" , "  "," " })	//"% Aumento"
Aadd(aHeader,{STR0019,"TAREFAVAL" ,"@E 999,999,999,999.99", 15 , 2 , "positivo()" , "Ш" , "N" , "  "," " })	//"Valor do Aumento"
aAlter := { "TAREFADE" , "TAREFAATE" , "TAREFAPERC" , "TAREFAVAL" }

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё// Inicializa 1╖ Item                                         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aTELA  := { 0,0 }
aGETS  := { 0 }
nUsado := 5
aCols  := {}
Aadd( aCols, { 0.01, 0.00 , 0.00 , 0.00 , .F. } )

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Verifica as perguntas selecionadas                           Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
pergunte("REAJTA",.F.)

Titulo := STR0020	    // "RELACAO DE AUMENTO DE TAREFAS"
                        
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Envia controle para a funcao SETPRINT                        Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
wnrel:="REAJTAR"       //Nome Default do relatorio em Disco
wnrel:=SetPrint(cString,wnrel,cPerg,@Titulo,cDesc1,cDesc2,cDesc3,.F.,aOrd,,nTamanho)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Variaveis utilizadas para parametros                         Ё
//Ё       mv_par01      Codigo Tarefa De                         Ё
//Ё       mv_par02      Codigo Tarefa Ate                        Ё
//Ё       mv_par03      Criterio de Arred.                       Ё
//Ё       mv_par04      Arredonda Em R$                          Ё
//Ё       mv_par05      Atualiza Cadastro                        Ё
//Ё       mv_par06      Tipo de Relatorio                        Ё
//Ё       mv_par07      Filial De                                Ё
//Ё       mv_par08      Filial Ate                               Ё
//Ё       mv_par09      Centro de Custo De                       Ё
//Ё       mv_par10      Centro de Custo Ate                      Ё
//Ё       mv_par11      Matricula De                             Ё
//Ё       mv_par12      Matricula Ate                            Ё
//Ё       mv_par13      Funcao De                                Ё
//Ё       mv_par14      Funcao Ate                               Ё
//Ё       mv_par15      Qual Categoria                           Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
nOrdem      := aReturn[8]
cTarDe      :=  mv_par01
cTarAte     :=  mv_par02
nCriterio   :=  mv_par03
nArredonda  :=  mv_par04
nRelAtu     :=  mv_par05
nTarFunAmb  :=  mv_par06
cFilDe      :=  mv_par07
cFilAte     :=  mv_par08
cCcDe       :=  mv_par09
cCcAte      :=  mv_par10
cMatDe      :=  mv_par11
cMatAte     :=  mv_par12
cFunDe      :=  mv_par13
cFunAte     :=  mv_par14
cCategoria  :=  mv_par15
wCabec1     := wCabec1 + "  "

If nLastKey == 27
	Return
Endif
SetDefault(aReturn,cString)
If nLastKey == 27
	Return
Endif

RptStatus({|| ReajImp()},Titulo)// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> 	RptStatus({|| Execute(ReajImp)},Titulo)

Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    Ё REAJIMP  Ё Autor Ё R.H. - Emerson        Ё Data Ё 17/12/99 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Aumento para Tarefas                                       Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe   Ё REAJIMP()    			                                  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso      Ё Generico                                                   Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function ReajImp
Static Function ReajImp()

Local n
Local nCnt
Local K

lRepara   := .T.
nUsar     := 0
cDeOnde   := ""
cTip      := "59" // Tarefas
nSavRec   := RecNo()
aColsTar  := {}  // Contera as tarefas cadatradas no SRX
aTarReaj  := {}  // Contera as tareas que foram reajustadas
aRecTar   := {}  // Contera o Recno() do SRX
aTotTar1  := {}  // Contera os totais da tarefa (Parametro) que serao impressos
aTotFun1  := {}  // Contera os totais da Funcao que serao impressos
aTotCC1   := {}  // Contera os totais do CC que serao impressos
aTotFil1  := {}  // Contera os totais da Filial que serao impressos
aTotEmp1  := {}  // Contera os totais da Empresa que serao impressos
aTotaliza := {}  // Servira para imprimir os totalizadores dentro da funcao fImpReaj(Tar/Fun)
aInfo     := {}
aPosicao1 := {}
Continua  := .F.
nUsado    := 0
nElem	  := 0
nTipAtu   := 0   // Identifica a atualizacao 1-Tarefa 2-Funcao 3-CC 4-Filial 5-Empresa
cArqDBF   := ""
cArqNTX   := ""

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Variaveis do Rodape do Modelo 2                              Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
nLinGetD:=0

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Titulo da Janela                                             Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cTitulo:="INDICE PARA AUMENTO DE TAREFA"
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Array com descricao dos campos do Cabecalho do Modelo 2      Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aC:={}

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Array com descricao dos campos do Rodape do Modelo 2         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aR:={}

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Array com coordenadas da GetDados no modelo2                 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aCGD:={44,5,118,315}

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Chamada da Modelo2                                           Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
// lRetMod2 = .T. se confirmou
// lRetMod2 = .F. se cancelou
lRetMod2:=Modelo2(cTitulo,aC,aR,aCGD,nOpcx,'REAJLOK()')
// No Windows existe a funcao de apoio CallMOd2Obj() que retorna o
// objeto Getdados Corrente

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Se cancelou operacao, retorna.                               Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
IF ! lRetMod2
	Return
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Se nao foi digitado indices para o aumento, retorna.         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Len(Acols) == 0
	Return
Endif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Desconsidera Faixas deletadas                                Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aFaixas := {}
For n := 1 To Len(aCols)
	If aCols[n,5] == .F.
		Aadd(aFaixas,{ aCols[n,1] , aCols[n,2] , aCols[n,3] , aCols[n,4] , aCols[n,5] })
	Endif
Next n

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Verifica o Numero de Linhas Para Cada Registro               Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
dbSelectArea("Sx2")
dbSeek("SRX")
dbSelectArea("SR5")
dbSetOrder(2)
dbSeek("  X" + cTip )
nRegistros := If(R5_TAMANHO<=0,1,R5_TAMANHO)
While !EOF() .And. ( ALLTRIM(R5_ARQUIVO) == "X" + cTip )
	If R5_usado != " " .And. cNivel >= Val( R5_NIVEL )
		nUsado := nUsado + 1
 	Endif
	dbSkip()
EndDo
dbSetOrder(1)

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Conta o Numero de Lancamentos das Tarefas                    Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
nCnt := 0
dbSelectArea("SRX")
dbSetOrder(2)
dbSeek( cTip )
While !Eof() .And. ALLTRIM(RX_TIP) == cTip
	nCnt := nCnt + 1
	dbSkip()
Enddo
nCnt := Int(nCnt/nRegistros)
	
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Monta aColsTar Com os Dados da Tarefa Definidos no SRX       Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aColsTar := Array( nCnt , nUsado + 1 )
nItens   := nCnt := 0
dbSelectArea("SRX")
dbSeek( cTip )
While !Eof() .And. ALLTRIM(RX_TIP) == cTip
	nReg := 1
	nCnt := nCnt + 1
	Aadd( aRecTar,Recno() ) // Guardar Recno Para Aumento da Tarefa
	If nCnt > Len(aColsTar)
		lRepara := .F.
		Help(" ",1,"A150REPARA")
		Exit
	Endif
	While ! Eof() .And. ALLTRIM(RX_TIP) == cTip .And. nReg <= nRegistros
		dbSelectArea("SR5")
		dbSeek( "  X" + cTip + STRZERO(nReg,2) )
		While !EOF() .And. ( ALLTRIM(R5_ARQUIVO) == "X" + cTip ) .And. VAL(R5_REG) <= nReg
			IF R5_usado != " " .And. cNivel >= Val( R5_NIVEL )
				nUsar := VAL(SR5->R5_POSICAO)
				nItens  := nItens + 1
				cDeOnde := "SRX->" + IF (ALLTRIM(SR5->R5_DEONDE) == "RX_CODCHAVE","RX_COD",ALLTRIM(SR5->R5_DEONDE))
				If ALLTRIM(R5_TIPO) == "C"
					aColsTar[nCnt,nUsar] := Subs(&cDeOnde,R5_DE,R5_QUANTOS)
				ElseIf ALLTRIM(R5_TIPO) == "N"
					aColsTar[nCnt,nUsar] := VAL(Subs(&cDeOnde,R5_DE,R5_QUANTOS))
				ElseIf ALLTRIM(R5_TIPO) == "D"
					aColsTar[nCnt,nUsar] := CTOD((Subs(&cDeOnde,R5_DE,R5_QUANTOS)))
				Endif
			Endif
			dbSkip()
		EndDo
		dbSelectArea("SRX")
		nReg := nReg + 1
		dbSkip()
	EndDo
	aColsTar[nCnt][nUsado+1] := .F.
	nReg := nReg + 1
EndDo
If !lRepara
	Return
Endif
If nItens == 0 .And. lRepara
	Help(" ",1,"A150SP")
	Return
Endif

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Reajusta as Tarefas e Grava no Array aTarReaj		         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
fReajTarefa()

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Se nao houve reajuste, retorna 						         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If Len(aTarReaj) == 0
	Return
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//| Monta Arquivo Temporario Para Listar Tarefeiros              |
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If nRelAtu == 1 .And. nTarFunAmb #1   //-- nao atualiza tarefa e relat.nao for somente de tarefas 
	Monta_TFA()
EndIf

If nRelAtu == 1
	Set Device To Print
EndIf

If nRelAtu == 1 .And. nTarFunAmb #2 // Relatorio de Parametros ou Ambos
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Altera o TITULO de acordo com o relatorio escolhido 	 	 Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Titulo := STR0020 + "  -  " + STR0040  // "RELACAO DE AUMENTO DE TAREFAS"##"PARAMETROS"

	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Carrega "aInfo" com informacoes da Filial Corrente  	 	 Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If !fInfo(@aInfo,cFilAnt)
		Return
	Endif
	LI       := 0
	For nCnt := 1 To Len(aTarReaj)
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Inicializa Array para Totalizacao                            Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		aPosicao1 := {}
		Aadd( aPosicao1,{0,0,0,0,0} )

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Atualizando Array aPosicao1                                  Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		nElem := nCnt
		Atualiza()
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Atualiza Totalizador de Tarefas								 Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		nTipAtu := 1     // Atualiza aTotTar1
		fAtuCont()
  			
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Imprime a Tarefa Reajustada                                  Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    fImpTar(nCnt)
	Next nCnt
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Totaliza as tarefas acumuladas								 |
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	fTotalTarefa()
ElseIf nRelAtu == 2
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Grava no SRX a Tarefa Reajustada                             Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	fGravaReaj()
EndIf

If nRelAtu == 1 .And. nTarFunAmb #1 // Relatorio de Funcionarios ou Ambos
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Altera o TITULO de acordo com o relatorio escolhido 	 	 Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	Titulo := STR0020 + "  -  " + STR0041  // "RELACAO DE AUMENTO DE TAREFAS"##"FUNCIONARIOS"

	dbSelectArea( "TFA" )
	dbGoTop()
	LI         := 0
	cFilialAnt := "!!"
	cCcAnt     := "!!!!!!!!!"
	cFuAnt     := "!!!!"
	cMatAnt    := "!!!!!!"
	lNovaMat   := .F.
	lImpCabe   := .F.
	lImpFunc   := .F.
	lMudouMat  := .F.
	While ! EOF()
		If TFA->FA_FILIAL #cFilialAnt
			If !fInfo(@aInfo,TFA->FA_FILIAL)
				Exit
			Endif
			dbSelectArea( "TFA" )
			cFilialAnt := TFA->FA_FILIAL
		Endif
   
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Inicializa Array para Totalizacao                            Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		aPosicao1 := {}
		Aadd( aPosicao1,{0,0,0,0,0} )

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Atualizando Array aPosicao1                                  Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		nElem := Ascan( aTarReaj, { |X| X[1] == TFA->FA_CODTAR } )
		If nElem > 0
			Atualiza()
		EndIf

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Atualizando Totalizadores                                    Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		nTipAtu := 2
		fAtuCont()  // Funcao		
		nTipAtu := 3		
		fAtuCont()  // Centro de Custo
		nTipAtu := 4
		fAtuCont()  // Filial
		nTipAtu := 5
		fAtuCont()  // Empresa
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se e novo funcionario para imprimir o cabecalho     Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		lNovaMat := ( cMatAnt #TFA->FA_MAT )
		cMatAnt  := TFA->FA_MAT
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica se proximo registro e do mesmo funcionario 		 Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		nRecno := RECNO()
		dbskip()            
		lMudouMat := ( cMatAnt #TFA->FA_MAT )
		dbGoTo(nRecno)
		
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Imprime o Funcionario                                        Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	    fImpFun()
    	fTestaTotal()
	EndDo
EndIf
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Termino do relatorio                                         Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
Set Device To Screen
If aReturn[5] == 1
	Set Printer To
	//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
	//Ё Spool caso Opcao seja de Relatorio, senao sai apresenta-lo.  Ё
	//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
	If nRelAtu == 1
		ourspool(wnrel)
	Endif
Endif
MS_FLUSH()

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Exclui o arquivo temporario criado p/ impressao do relatorio Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If nRelAtu == 1 .And. nTarFunAmb #1
	dbSelectArea( "TFA" )
	dbCloseArea()
	fErase(cArqNtx + OrdBagExt())
	fErase(cArqDbf + GetDBExtension())
EndIf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Restaura a integridade dos arquivos							 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
dbSelectArea( "SRX" )
dbSetOrder(1)
dbSelectArea( "SR5" )
dbSetOrder(1)
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠здддддддддбдддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o   ЁfReajTarefaЁ Autor Ё Emerson R. de Souza   Ё Data Ё 21/12/99 Ё╠╠
╠╠цдддддддддедддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘oЁReajusta as Tarefas Definidas no Parametro                   Ё╠╠
╠╠цдддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso     Ё Generico                                                    Ё╠╠
╠╠юдддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fReajTarefa
Static Function fReajTarefa()

Local K

nTarNova  := 0
nTarAnti  := 0 
nTarPerc  := 0
nValArred := 0
For k := 1 To Len(aColsTar)
	If aColsTar[k,D_CODIGO] >= cTarDe .And. aColsTar[k,D_CODIGO] <= cTarAte
		nTarAnti := aColsTar[k,D_ANTIGO]
		nPos     := Ascan(aFaixas, { |X| nTarAnti >= X[1] .And. nTarAnti <= X[2] })
		If nPos > 0
			nTarPerc := aFaixas[nPos,3]
			nTarNova := nTarAnti
			nTarNova := nTarAnti * ( 1 + ( nTarPerc / 100 ) )
			nTarNova := nTarNova + aFaixas[nPos,4]
			If nCriterio == 1
				nTarNova := NoRound(nTarNova)
			ElseIf nCriterio == 2
				nTarNova := Round(nTarNova,2)
			Else				
				If nTarNova - Round(nTarNova,2) > 0.00
					nTarNova := NoRound((nTarNova + .01),2)
				Else
					nTarNova := Round(nTarNova,2)
				Endif
			Endif
			If nArredonda #0
				nResto := Mod(nTarNova,nArredonda)
				If Round(nResto,2) > 0.00
					nValArred := nArredonda - nResto
					nTarNova  := nTarNova + nValArred
				Else
					nValArred := 0.00
				Endif
			Endif
			Aadd(aTarReaj, { aColsTar[k,D_CODIGO], aColsTar[k,D_DESCRI],;
		    				  aColsTar[k,D_ANTIGO], aColsTar[k,D_VERBA],;
		     				  nTarPerc, nTarNova-nTarAnti, 	nTarNova, nValArred } )
			aColsTar[k,D_ANTIGO] := nTarNova
		EndIf
	EndIf
Next k
Return

/*
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o    ЁfGravaReajЁ Autor Ё Emerson Rosa de Souza Ё Data Ё 29.12.99 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Grava as Tarefas Reajustadas no arquivo de Parametros e SROЁ╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso      Ё fGravaReaj                                                 Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fGravaReaj
Static Function fGravaReaj()

Local nCont:= 0

cCpoRet := "" // Campo que sera preenchido em a150Transf

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Grava a Tarefa Reajustada no Cadastro de Parametros			 Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
For nCont := 1 To Len(aColsTar)
	If Ascan(aTarReaj, { |X| X[1] == aColsTar[nCont,1] }) > 0
		cChaveRX_COD := ""
		nCol 		 := 0
		cChaveRX_COD := ""
		nCol         := 0
		nReg 		 := 1
		cCod 		 := SPACE(11)
		cTxt 		 := SPACE(60)
		dbSelectArea("SR5")
		dbSeek( "  X" + cTip + STRZERO(nReg,2) )
		While !EOF() .And. ( ALLTRIM(R5_ARQUIVO) == "X" + cTip  )
			While !EOF() .And. ( ALLTRIM(R5_ARQUIVO) == "X" + cTip ) .And. VAL(R5_REG) == nReg
				If  ALLTRIM(R5_TIPO) == "F"
					IF ALLTRIM(R5_DEONDE) == "RX_TXT"
						cTxt := If(R5_DE==1,"",Subs(cTxt,1,(R5_DE-1)))+SUBS(R5_RELACAO,1,R5_TAMANHO)+Subs(cTxt,R5_DE+R5_QUANTOS,60-(R5_DE+R5_QUANTOS))
					ELSEIF ALLTRIM(R5_DEONDE) == "RX_COD"
						cCod := If(R5_DE==1,"",Subs(cCod,1,(R5_DE-1)))+SUBS(R5_RELACAO,1,R5_TAMANHO)+Subs(cCod,R5_DE+R5_QUANTOS,11-(R5_DE+R5_QUANTOS))
					ENDIF
				ElseIf ( R5_usado != " " .And. cNivel >= Val( R5_nivel ) )
					nCol := nCol + 1
					IF ALLTRIM(R5_DEONDE) == "RX_TXT"                                        
    					a150Transf(nCont) // Converte aColsTar e carrega em cCpoRet
						cTxt := If(R5_DE==1,"",Subs(cTxt,1,(R5_DE-1)))+cCpoRet+Subs(cTxt,R5_DE+R5_QUANTOS,60-(R5_DE+R5_QUANTOS))
					ELSEIF ALLTRIM(R5_DEONDE) == "RX_COD"
						If VAL(R5_REG) == 1 .And. ALLTRIM(R5_DEONDE) == "RX_CODCHAVE"
	    					a150Transf(nCont) // Converte aColsTar e carrega em cCpoRet
							cChaveRX_COD := cChaveRX_COD + cCpoRet
						Endif                                                      
    					a150Transf(nCont) // Converte aColsTar e carrega em cCpoRet
						cCod := If(R5_DE==1,"",Subs(cCod,1,(R5_DE-1)))+cCpoRet+Subs(cCod,R5_DE+R5_QUANTOS,11-(R5_DE+R5_QUANTOS))
					ENDIF
				ElseIf R5_usado == " " .And. ALLTRIM(R5_DEONDE) == "RX_CODCHAVE"
					cCod := Left(cChaveRX_COD+Space(11),11)
				Endif
				dbSkip()
			EndDo
			If Len(AllTrim(cTxt)) == 0
				Exit
			Endif
			dbSelectArea("SRX")
			dbGoTo(aRecTar[nCont]) // Posiciona no registro para gravar a tarefa reajustada
			RecLock("SRX",.F.)
			SRX->RX_TIP := cTip
			SRX->RX_COD := cCod
			SRX->RX_TXT := cTxt
			MsUnlock()
			nReg := nReg + 1
			cTxt := Space(60)
			cCod := Space(11)
			dbSelectArea("SR5")
		Enddo
	EndIf
Next nCont

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Grava a Tarefa Reajustada nos Lancamentos Dos Funcionarios   Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
cAlias := Alias()
dbSelectArea("SRO")
dbGoTop()
While ! EOF()
	nPos := Ascan(aTarReaj, { |X| X[1] == SRO->RO_CODTAR } )
	If nPos > 0
		RecLock( "SRO", .F. )
		SRO->RO_VALOR  := aTarReaj[nPos,D_NOVO]
		SRO->RO_VALTOT := aTarReaj[nPos,D_NOVO] * SRO->RO_QUANT
		MsUnLock()
	EndIf
	dbSkip()
EndDo
dbSelectArea(cAlias)
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  Ёa150Transf╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁConverte o Campo de Acordo com o Tipo                       ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function a150Transf
Static Function a150Transf(nCont)
cCpoRet := ""
If ALLTRIM(R5_TIPO) == "C"
	cCpoRet := aColsTar[nCont,nCol]
ElseIf ALLTRIM(R5_TIPO) == "N"
	cCpoRet := Str(aColsTar[nCont,nCol],R5_TAMANHO,R5_DECIMAL)
ElseIf ALLTRIM(R5_TIPO) == "D"
	cCpoRet := dTos(aColsTar[nCont,nCol])
Endif
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁAtualiza  ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁAtualiza o Array aPosicao1                                  ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function Atualiza
Static Function Atualiza()
aPosicao1[1,1] := aTarReaj[nElem,D_ANTIGO]
aPosicao1[1,2] := aTarReaj[nElem,D_PERC]
aPosicao1[1,3] := aTarReaj[nElem,D_REAJ]
aPosicao1[1,4] := aTarReaj[nElem,D_NOVO]
aPosicao1[1,5] := aTarReaj[nElem,D_ARRE]
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfAtuCont  ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁAtualiza os Totalizadores                                   ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fAtuCont
Static Function fAtuCont()

Local X

If nTipAtu == 1    
	aArray1 := aTotTar1	
ElseIf nTipAtu == 2
	aArray1 := aTotFun1
ElseIf nTipAtu == 3
	aArray1 := aTotCC1
ElseIf nTipAtu == 4
	aArray1 := aTotFil1
Else
	aArray1 := aTotEmp1
EndIf

If  Len(aArray1) > 0
	For x := 1 To 5
		aArray1[1,x] := aArray1[1,x] + aPosicao1[1,x]
	Next x
Else
	aArray1 := Aclone(aPosicao1)
Endif

If nTipAtu == 1
	aTotTar1 := aArray1	
ElseIf nTipAtu == 2	
	aTotFun1 := aArray1
ElseIf nTipAtu == 3	
	aTotCC1 := aArray1
ElseIf nTipAtu == 4	
	aTotFil1 := aArray1
Else
	aTotEmp1 := aArray1
EndIf
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpReajTa╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime a Linha de Totais                                   ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpReajTar
Static Function fImpReajTar()
cDet := STR0038 // "TAREFA ANTIGA          PERCENTUAL          REAJUSTE          NOVA TAREFA          ARREDONDAMENTO"
Impr(cDet,"C")
cDet :=        Space(01) + TRANSFORM(aTotaliza[1,1],"@E 999999999.99")
cDet := cDet + Space(08) + TRANSFORM(aTotaliza[1,2],"@E 99999.999999")
cDet := cDet + Space(06) + TRANSFORM(aTotaliza[1,3],"@E 999999999.99")		
cDet := cDet + Space(09) + TRANSFORM(aTotaliza[1,4],"@E 999999999.99")
cDet := cDet + Space(12) + TRANSFORM(aTotaliza[1,5],"@E 999999999.99")
Impr(cDet,"C")
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁMonta_TFA ╨Autor  ЁR.H.	             ╨ Data Ё  12/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     Ё Monta Arquivo Temporario Para Impressao dos Tarefeiros     ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Local                                                      ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function Monta_TFA
Static Function Monta_TFA()
Cria_TFA()
dbSelectArea("SRA")
dbSetOrder(1)
dbSelectArea("SRO")
dbGoTop()
While !EOF()
	If SRO->RO_CODTAR >= cTarDe .And. SRO->RO_CODTAR <= cTarAte
		dbSelectArea("SRA")
		dbSeek(SRO->RO_FILIAL+SRO->RO_MAT)
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Consiste Parametrizacao do Intervalo de Impressao            Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If	( SRA->RA_MAT     < cMatDe ) .Or. ( SRA->RA_MAT     > cMatAte ) .Or. ;
			( SRA->RA_CC      < cCcDe  ) .Or. ( SRA->RA_CC      > cCcAte  ) .Or. ;
			( SRA->RA_CODFUNC < cFunDe ) .Or. ( SRA->RA_CODFUNC > cFunAte )
			dbSelectArea("SRO")
			dbSkip()
			Loop
		EndIf
		
		/*
		зддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		ЁConsiste Filiais e Acessos                                             Ё
		юддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды*/
		IF !( SRA->RA_FILIAL $ fValidFil() .and. Eval( cAcessaSRA ) )
			dbSelectArea("SRA")
			dbSkip()
		Loop
		EndIF
			
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Verifica a Categoria e Situacao do Funcionario               Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If !( SRA->RA_CATFUNC  $ cCategoria ) .Or. !( SRA->RA_SITFOLH $ " *F*A" )
			dbSelectArea("SRO")
			dbSkip()
			Loop
		Endif

		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Grava o Funcionario no TFA Para Emissao do Relatorio         Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		dbSelectArea("TFA")
		RecLock( "TFA", .T. )
		
		TFA->FA_FILIAL  := SRA->RA_FILIAL
		TFA->FA_MAT     := SRA->RA_MAT
		TFA->FA_CC      := SRA->RA_CC
		TFA->FA_CODFUNC := SRA->RA_CODFUNC
		TFA->FA_NOME    := SRA->RA_NOME
		TFA->FA_ADMISSA := SRA->RA_ADMISSA
		TFA->FA_CATFUNC := SRA->RA_CATFUNC
		TFA->FA_SINDICA := SRA->RA_SINDICA
		TFA->FA_VERBA   := SRO->RO_VERBA
		TFA->FA_DATADE  := SRO->RO_DATA
		TFA->FA_CODTAR  := SRO->RO_CODTAR
		//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
		//Ё Checa a existencia do campo RO_DATAATE no arquivo SRO        Ё
		//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
		If Type("SRO->RO_DATAATE") #"U"
			TFA->FA_DATAATE := SRO->RO_DATAATE
		EndIf
		MsUnLock()
		dbSelectArea("SRO")
	EndIf
	dbSkip()
EndDo
Return

/*/
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠зддддддддддбддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o	 Ё Cria_TFA	Ё Autor Ё R.H. -	     		| Data Ё 12.01.99 Ё╠╠
╠╠цддддддддддеддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘o Ё Criar Arquivo de Trabalho Para Relatorio de Tarefeiros     |╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠ЁSintaxe	 Ё CRIA_TFA()	 											  Ё╠╠
╠╠цддддддддддедддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso		 Ё Generico 												  Ё╠╠
╠╠юддддддддддадддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ/*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> FUNCTION Cria_Tfa
Static FUNCTION Cria_Tfa()
cArqDBF := CriaTrab(NIL,.f.)
aFields := {}
AADD(aFields,{"FA_FILIAL" ,"C",02,0})
AADD(aFields,{"FA_MAT"    ,"C",06,0})
AADD(aFields,{"FA_CC"     ,"C",09,0})
AADD(aFields,{"FA_CODFUNC","C",04,0})
AADD(aFields,{"FA_ADMISSA","D",08,0})
AADD(aFields,{"FA_CATFUNC","C",01,0})
AADD(aFields,{"FA_SINDICA","C",02,0})
AADD(aFields,{"FA_CODTAR" ,"C",03,0})
AADD(aFields,{"FA_VERBA"  ,"C",03,0})
AADD(aFields,{"FA_NOME"   ,"C",30,0})
AADD(aFields,{"FA_DATADE" ,"D",08,0})
AADD(aFields,{"FA_DATAATE","D",08,0})

DbCreate(cArqDbf,aFields)
DbUseArea(.T.,,cArqDbf,"TFA",.F.)
If nOrdem == 1
	cIndCond := "FA_FILIAL+FA_MAT+FA_CODTAR"
ElseIf nOrdem == 2
	cIndCond := "FA_FILIAL+FA_CC+FA_MAT+FA_CODTAR"
Else                                        
	cIndCond := "FA_FILIAL+FA_CODFUNC+FA_MAT+FA_CODTAR"
EndIf
cArqNtx  := CriaTrab(NIL,.f.)
IndRegua("TFA",cArqNtx,cIndCond,,,STR0035)  //"Selecionando Registros..."
dbGoTop()
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfTotalTare╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime os Totais das Tarefas								  ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fTotalTarefa
Static Function fTotalTarefa()
cDet:=STR0034+aInfo[3]		//"Empresa: "
Impr(cDet,"C")
Impr("","C")

aTotaliza := aTotTar1
fImpReajTar()
aTotTar1  :={}

Impr("","F")
Return
/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpTar   ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime a Tarefa do Cadastro de Parametros                  ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpTar
Static Function fImpTar(nCnt)
cDet := STR0026+cFilAnt+Space(2)+STR0036+aTarReaj[nCnt,D_CODIGO]+Space(2)+;  	  // "FILIAL:"#"TAREFA: "
		 Left(aTarReaj[nCnt,D_DESCRI]+Space(30),30)+STR0037+aTarReaj[nCnt,D_VERBA] //  " VERBA: "

Impr(cDet,"C")
Impr("","C")
                        
//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Impressao do Array aPosicao1					 			 |
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
aTotaliza := aPosicao1
fImpReajTar()

If nCnt+1 <= Len(aTarReaj)
	Impr("","C")
	cDet := Repl("-",132)
	Impr(cDet,"C")
Else 
	Impr("","C")
	cDet := Repl("#",132)
	Impr(cDet,"C")
EndIf
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfTestaTota╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime as Quebras Totalizando-as                           ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fTestaTotal
Static Function fTestaTotal()
dbSelectArea( "TFA" )
cFilialAnt := TFA->FA_FILIAL
cCcAnt     := TFA->FA_CC
cFuAnt     := TFA->FA_CODFUNC
dbSkip()

If Eof()
	fImpFu()
	fImpCc()
	fImpFil()
	fImpEmp()
Elseif cFilialAnt #TFA->FA_FILIAL
	fImpFu()
	fImpCc()
	fImpFil()
Elseif cCcAnt #TFA->FA_CC
	fImpCc()
Elseif cFuAnt #TFA->FA_CODFUNC
	fImpFu()
Endif
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpReajFu╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime a Linha de Totais dos Funcionarios                  ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpReajFun
Static Function fImpReajFun()

If lImpFunc
	If lImpCabe
		cDet := STR0039 // "TAREFA     VERBA     DT.TAREFA DE     DT.TAREFA ATE     TAREFA ANTIGA     PERCENTUAL     REAJUSTE     NOVA TAREFA     ARREDONDAMENTO"
		Impr(cDet,"C")
	EndIf
	cDet := Space(2)+TFA->FA_CODTAR+Space(7)+TFA->FA_VERBA+Space(10)
	cDet := cDet + DTOC(TFA->FA_DATADE)+Space(10)+DTOC(TFA->FA_DATAATE)
	cDet := cDet + Space(06) + TRANSFORM(aTotaliza[1,1],"@E 999999999.99")
	cDet := cDet + Space(03) + TRANSFORM(aTotaliza[1,2],"@E 99999.999999")
	cDet := cDet + Space(01) + TRANSFORM(aTotaliza[1,3],"@E 999999999.99")		
	cDet := cDet + Space(04) + TRANSFORM(aTotaliza[1,4],"@E 999999999.99")
	cDet := cDet + Space(07) + TRANSFORM(aTotaliza[1,5],"@E 999999999.99")
Else
	cDet := STR0038 // "TAREFA ANTIGA          PERCENTUAL          REAJUSTE          NOVA TAREFA          ARREDONDAMENTO"
	Impr(cDet,"C")
	cDet := Space(01) + TRANSFORM(aTotaliza[1,1],"@E 999999999.99")
	cDet := cDet + Space(08) + TRANSFORM(aTotaliza[1,2],"@E 99999.999999")
	cDet := cDet + Space(06) + TRANSFORM(aTotaliza[1,3],"@E 999999999.99")		
	cDet := cDet + Space(09) + TRANSFORM(aTotaliza[1,4],"@E 999999999.99")
	cDet := cDet + Space(12) + TRANSFORM(aTotaliza[1,5],"@E 999999999.99")
EndIf
Impr(cDet,"C")
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpFun   ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime o Funcionario                                       ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpFun
Static Function fImpFun()
lImpCabe := .F.        // Indica se deve ser impresso o cabecalho das tarefas
lImpFunc := .T.        // Indica que o funcionario sera impresso
If lNovaMat
	cDet := STR0026+TFA->FA_FILIAL+STR0027+TFA->FA_CC+STR0028+TFA->FA_MAT+; 									    // "FILIAL: "#"CCTO: "#" MAT: "
			STR0029+TFA->FA_NOME+STR0030+DTOC(TFA->FA_ADMISSA)+STR0031+TFA->FA_CATFUNC+STR0032+TFA->FA_SINDICA  // " NOME: "#"DT.ADMISSAO: "#"CATEGORIA"#"SINDICATO"
	Impr(cDet,"C")
	Impr("","C")
	lImpCabe := .T.
EndIf

aTotaliza := aPosicao1
fImpReajFun()

If lMudouMat
	Impr("","C")
	cDet := Repl("-",132)
	Impr(cDet,"C")
EndIf
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpFu    ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime a Quebra Por Funcao                                 ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpFu
Static Function fImpFu()
If Len(aTotFun1) == 0 .Or. nOrdem #3
	Return
Endif

cDet:=STR0026+cFilialAnt+STR0033+cFuAnt+" - "+DescFun(cFuAnt,cFilialAnt)	//"FILIAL: "###" FUNCAO: "
Impr(cDet,"C")
Impr("","C")
           
lImpFunc  := .F.        // Indica que o totalizador sera impresso
aTotaliza := aTotFun1   //  Array que sera impressa dentro de fImpReajFun
fImpReajFun()

aTotFun1 :={}

Impr("","C")
cDet := Repl("=",132)
Impr(cDet,"C")
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpCc    ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime a Quebra Por Centro de Custo                        ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpCc
Static Function fImpCc()
If Len(aTotCc1) == 0 .Or. nOrdem #2
	Return
Endif

cDet:=STR0026+cFilialAnt+STR0027+cCcAnt+" - "+DescCc(cCcAnt,cFilialAnt)	//"FILIAL: "###" CCTO: "
Impr(cDet,"C")
Impr("","C")

lImpFunc  := .F.        // Indica que o totalizador sera impresso
aTotaliza := aTotCC1    //  Array que sera impressa dentro de fImpReajFun
fImpReajFun()

aTotCc1 :={}

Impr("","C")
cDet := Repl("=",132)
Impr(cDet,"C")
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpFil   ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime a Quebra Por Filial                                 ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpFil
Static Function fImpFil()
If Len(aTotFil1) == 0
	Return
Endif

cDescFil := aInfo[1] + Space(25)
cDet     := STR0026+cFilialAnt+" - "+cDescFil	//"FILIAL: "
Impr(cDet,"C")
Impr("","C")
           
lImpFunc  := .F.        // Indica que o totalizador sera impresso
aTotaliza := aTotFil1   //  Array que sera impressa dentro de fImpReajFun
fImpReajFun()

aTotFil1 :={}

Impr("","C")
cDet := Repl("#",132)
Impr(cDet,"C")
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠иммммммммммяммммммммммкмммммммяммммммммммммммммммммкммммммяммммммммммммм╩╠╠
╠╠╨Programa  ЁfImpEmp   ╨Autor  ЁMICROSIGA           ╨ Data Ё  13/01/00   ╨╠╠
╠╠лммммммммммьммммммммммймммммммоммммммммммммммммммммйммммммоммммммммммммм╧╠╠
╠╠╨Desc.     ЁImprime a Quebra Por Empresa                                ╨╠╠
╠╠лммммммммммьмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╧╠╠
╠╠╨Uso       Ё Generico                                                   ╨╠╠
╠╠хммммммммммомммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╪╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> Function fImpEmp
Static Function fImpEmp()
If Len(aTotEmp1) == 0
	Return
Endif

cDet:=STR0034+aInfo[3]		//"Empresa: "
Impr(cDet,"C")
Impr("","C")

lImpFunc  := .F.        // Indica que o totalizador sera impresso
aTotaliza := aTotEmp1   //  Array que sera impressa dentro de fImpReajFun
fImpReajFun()

aTotEmp1 :={}

Impr("","F")
Return

/*
эээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээээ
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
╠╠здддддддддбдддддддддддбдддддддбдддддддддддддддддддддддбддддддбдддддддддд©╠╠
╠╠ЁFun┤┘o   ЁREAJLOK    Ё Autor Ё R.H.					Ё Data Ё 21/12/99 Ё╠╠
╠╠цдддддддддедддддддддддадддддддадддддддддддддддддддддддаддддддадддддддддд╢╠╠
╠╠ЁDescri┤┘oЁCritica linha digitada                                       Ё╠╠
╠╠цдддддддддеддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢╠╠
╠╠Ё Uso     Ё Generico                                                    Ё╠╠
╠╠юдддддддддаддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды╠╠
╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠╠
ъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъъ*/
Function REAJLOK
nLinGetD := n
lRetorna := .T.
Continua := .F.
aFaixas1 := {}

//здддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд©
//Ё Desconsidera Faixas deletadas                                Ё
//юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
If aCols[nLinGetD,5] == .F.
	If aCols[nLinGetD,1] > aCols[nLinGetD,2]
		Help(" ",1,"GR200FAIXA")
		lRetorna := .F.
	Endif
	
	If nLinGetD > 1
		If aCols[nLinGetD,1] <= aCols[nLinGetD-1,2]
			Help(" ",1,"GR200FAIXA")
			lRetorna := .F.
		Endif
	Endif
	
	If ( aCols[nLinGetD,3] == 0 ) .And. ( aCols[nLinGetD,4] == 0 )
		Help(" ",1,"GR200ZEROS")
		lRetorna := .F.
	Endif
Endif
// Substituido pelo assistente de conversao do AP5 IDE em 10/02/00 ==> __Return(lRetorna)
Return(lRetorna)        // incluido pelo assistente de conversao do AP5 IDE em 10/02/00
